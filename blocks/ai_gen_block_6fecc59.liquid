{% doc %}
  @prompt
    create me a Bestseller selection. A  slider with 3 products. On desktop, all 3 next to each other. On mobile, they should be a slider. All 3 products should be clickable to go to the product. Corner rounding should be editable. All three products should have an editable badge on the top left. Color and text editable. Spacing on all sides should be editable for mobile and desktop. The images should have a slight floating effect. The selection should look premium, make the container height editable. Center the images on mobile, make the mobile images square, make it a slider for mobile., Change the one setting for padding and split it up for all sides. and top and bottom. Make the bottom space of the container editable on mobile.  Move the 3 dots closer to the product card. , remove the dead space of the container on mobile below the 3 dots, the container / frame of the image should be slightly increased. On the hover effect, the images get slightly cut off on the top. REST IS GOOD!, make the whole product card rounded with the setting. Top and bottom, when hovering, the image gets cut off at the top. adapt it so that the image container as a whole hovers and it does not get cut off, on mobile, make sure as the image hovers, the top of the image does not get cut off. 
{% enddoc %}
{% assign ai_gen_id = block.id | replace: '_', '' | downcase %}

{% style %}
  .ai-bestseller-slider-{{ ai_gen_id }} {
    display: block;
    width: 100%;
    padding-top: {{ block.settings.desktop_padding_top }}px;
    padding-bottom: {{ block.settings.desktop_padding_bottom }}px;
    padding-left: {{ block.settings.desktop_padding_sides }}px;
    padding-right: {{ block.settings.desktop_padding_sides }}px;
    background-color: {{ block.settings.background_color }};
  }

  .ai-bestseller-container-{{ ai_gen_id }} {
    max-width: 100%;
    margin: 0 auto;
    height: {{ block.settings.container_height }}px;
    padding: 20px;
  }

  .ai-bestseller-grid-{{ ai_gen_id }} {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: {{ block.settings.desktop_gap }}px;
    height: 100%;
  }

  .ai-bestseller-product-{{ ai_gen_id }} {
    position: relative;
    display: flex;
    flex-direction: column;
    height: 100%;
    text-decoration: none;
    color: inherit;
    border-radius: {{ block.settings.corner_radius }}px;
    overflow: visible;
    background-color: {{ block.settings.card_background }};
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
    transition: transform 0.4s ease, box-shadow 0.4s ease;
  }

  .ai-bestseller-product-{{ ai_gen_id }}:hover {
    transform: translateY(-8px);
    box-shadow: 0 12px 24px rgba(0, 0, 0, 0.15);
  }

  .ai-bestseller-image-wrapper-{{ ai_gen_id }} {
    position: relative;
    width: 100%;
    height: 100%;
    overflow: hidden;
    border-radius: {{ block.settings.corner_radius }}px {{ block.settings.corner_radius }}px 0 0;
  }

  .ai-bestseller-image-{{ ai_gen_id }} {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .ai-bestseller-badge-{{ ai_gen_id }} {
    position: absolute;
    top: 12px;
    left: 12px;
    background-color: {{ block.settings.badge_background }};
    color: {{ block.settings.badge_text_color }};
    padding: 6px 12px;
    border-radius: 4px;
    font-size: 12px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    z-index: 2;
  }

  .ai-bestseller-info-{{ ai_gen_id }} {
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 8px;
    border-radius: 0 0 {{ block.settings.corner_radius }}px {{ block.settings.corner_radius }}px;
    background-color: {{ block.settings.card_background }};
  }

  .ai-bestseller-title-{{ ai_gen_id }} {
    font-size: 16px;
    font-weight: 600;
    margin: 0;
    color: {{ block.settings.text_color }};
  }

  .ai-bestseller-price-{{ ai_gen_id }} {
    font-size: 18px;
    font-weight: 700;
    color: {{ block.settings.price_color }};
  }

  .ai-bestseller-mobile-slider-{{ ai_gen_id }} {
    display: none;
  }

  @media screen and (max-width: 749px) {
    .ai-bestseller-slider-{{ ai_gen_id }} {
      padding-top: {{ block.settings.mobile_padding_top }}px;
      padding-bottom: {{ block.settings.mobile_padding_bottom }}px;
      padding-left: {{ block.settings.mobile_padding_sides }}px;
      padding-right: {{ block.settings.mobile_padding_sides }}px;
    }

    .ai-bestseller-container-{{ ai_gen_id }} {
      height: auto;
      padding: 0;
    }

    .ai-bestseller-grid-{{ ai_gen_id }} {
      display: none;
    }

    .ai-bestseller-mobile-slider-{{ ai_gen_id }} {
      display: block;
      position: relative;
      overflow: visible;
      padding-top: 10px;
    }

    .ai-bestseller-mobile-track-{{ ai_gen_id }} {
      display: flex;
      gap: {{ block.settings.mobile_gap }}px;
      overflow-x: auto;
      scroll-snap-type: x mandatory;
      scrollbar-width: none;
      -webkit-overflow-scrolling: touch;
      padding-bottom: 8px;
    }

    .ai-bestseller-mobile-track-{{ ai_gen_id }}::-webkit-scrollbar {
      display: none;
    }

    .ai-bestseller-mobile-product-{{ ai_gen_id }} {
      flex: 0 0 85%;
      scroll-snap-align: center;
    }

    .ai-bestseller-mobile-product-{{ ai_gen_id }}:hover {
      transform: none;
    }

    .ai-bestseller-mobile-product-{{ ai_gen_id }} .ai-bestseller-image-wrapper-{{ ai_gen_id }} {
      aspect-ratio: 1 / 1;
    }

    .ai-bestseller-mobile-product-{{ ai_gen_id }} .ai-bestseller-info-{{ ai_gen_id }} {
      text-align: center;
    }

    .ai-bestseller-dots-{{ ai_gen_id }} {
      display: flex;
      justify-content: center;
      gap: 8px;
      margin-top: 8px;
    }

    .ai-bestseller-dot-{{ ai_gen_id }} {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background-color: {{ block.settings.dot_color }};
      opacity: 0.3;
      transition: opacity 0.3s ease;
    }

    .ai-bestseller-dot-{{ ai_gen_id }}.active {
      opacity: 1;
    }
  }
{% endstyle %}

<bestseller-slider-{{ ai_gen_id }} class="ai-bestseller-slider-{{ ai_gen_id }}" {{ block.shopify_attributes }}>
  <div class="ai-bestseller-container-{{ ai_gen_id }}">
    <div class="ai-bestseller-grid-{{ ai_gen_id }}">
      {% for i in (1..3) %}
        {% liquid
          assign product_key = 'product_' | append: i
          assign product = block.settings[product_key]
        %}
        
        {% if product != blank %}
          <a href="{{ product.url }}" class="ai-bestseller-product-{{ ai_gen_id }}">
            <div class="ai-bestseller-image-wrapper-{{ ai_gen_id }}">
              {% if product.featured_image %}
                <img
                  src="{{ product.featured_image | image_url: width: 800 }}"
                  alt="{{ product.featured_image.alt | escape }}"
                  class="ai-bestseller-image-{{ ai_gen_id }}"
                  loading="lazy"
                  width="800"
                  height="800"
                >
              {% else %}
                <div class="ai-bestseller-image-placeholder-{{ ai_gen_id }}">
                  {{ 'product-1' | placeholder_svg_tag }}
                </div>
              {% endif %}
              
              {% if block.settings.badge_text != blank %}
                <div class="ai-bestseller-badge-{{ ai_gen_id }}">
                  {{ block.settings.badge_text }}
                </div>
              {% endif %}
            </div>
            
            <div class="ai-bestseller-info-{{ ai_gen_id }}">
              <h3 class="ai-bestseller-title-{{ ai_gen_id }}">{{ product.title }}</h3>
              <div class="ai-bestseller-price-{{ ai_gen_id }}">{{ product.price | money }}</div>
            </div>
          </a>
        {% else %}
          <div class="ai-bestseller-product-{{ ai_gen_id }}">
            <div class="ai-bestseller-image-wrapper-{{ ai_gen_id }}">
              <div class="ai-bestseller-image-placeholder-{{ ai_gen_id }}">
                {{ 'product-1' | placeholder_svg_tag }}
              </div>
              
              {% if block.settings.badge_text != blank %}
                <div class="ai-bestseller-badge-{{ ai_gen_id }}">
                  {{ block.settings.badge_text }}
                </div>
              {% endif %}
            </div>
            
            <div class="ai-bestseller-info-{{ ai_gen_id }}">
              <h3 class="ai-bestseller-title-{{ ai_gen_id }}">Product {{ i }}</h3>
              <div class="ai-bestseller-price-{{ ai_gen_id }}">€0.00</div>
            </div>
          </div>
        {% endif %}
      {% endfor %}
    </div>

    <div class="ai-bestseller-mobile-slider-{{ ai_gen_id }}">
      <div class="ai-bestseller-mobile-track-{{ ai_gen_id }}" data-slider-track>
        {% for i in (1..3) %}
          {% liquid
            assign product_key = 'product_' | append: i
            assign product = block.settings[product_key]
          %}
          
          {% if product != blank %}
            <a href="{{ product.url }}" class="ai-bestseller-product-{{ ai_gen_id }} ai-bestseller-mobile-product-{{ ai_gen_id }}">
              <div class="ai-bestseller-image-wrapper-{{ ai_gen_id }}">
                {% if product.featured_image %}
                  <img
                    src="{{ product.featured_image | image_url: width: 600 }}"
                    alt="{{ product.featured_image.alt | escape }}"
                    class="ai-bestseller-image-{{ ai_gen_id }}"
                    loading="lazy"
                    width="600"
                    height="600"
                  >
                {% else %}
                  <div class="ai-bestseller-image-placeholder-{{ ai_gen_id }}">
                    {{ 'product-1' | placeholder_svg_tag }}
                  </div>
                {% endif %}
                
                {% if block.settings.badge_text != blank %}
                  <div class="ai-bestseller-badge-{{ ai_gen_id }}">
                    {{ block.settings.badge_text }}
                  </div>
                {% endif %}
              </div>
              
              <div class="ai-bestseller-info-{{ ai_gen_id }}">
                <h3 class="ai-bestseller-title-{{ ai_gen_id }}">{{ product.title }}</h3>
                <div class="ai-bestseller-price-{{ ai_gen_id }}">{{ product.price | money }}</div>
              </div>
            </a>
          {% else %}
            <div class="ai-bestseller-product-{{ ai_gen_id }} ai-bestseller-mobile-product-{{ ai_gen_id }}">
              <div class="ai-bestseller-image-wrapper-{{ ai_gen_id }}">
                <div class="ai-bestseller-image-placeholder-{{ ai_gen_id }}">
                  {{ 'product-1' | placeholder_svg_tag }}
                </div>
                
                {% if block.settings.badge_text != blank %}
                  <div class="ai-bestseller-badge-{{ ai_gen_id }}">
                    {{ block.settings.badge_text }}
                  </div>
                {% endif %}
              </div>
              
              <div class="ai-bestseller-info-{{ ai_gen_id }}">
                <h3 class="ai-bestseller-title-{{ ai_gen_id }}">Product {{ i }}</h3>
                <div class="ai-bestseller-price-{{ ai_gen_id }}">€0.00</div>
              </div>
            </div>
          {% endif %}
        {% endfor %}
      </div>
      
      <div class="ai-bestseller-dots-{{ ai_gen_id }}" data-dots>
        <span class="ai-bestseller-dot-{{ ai_gen_id }} active" data-dot="0"></span>
        <span class="ai-bestseller-dot-{{ ai_gen_id }}" data-dot="1"></span>
        <span class="ai-bestseller-dot-{{ ai_gen_id }}" data-dot="2"></span>
      </div>
    </div>
  </div>
</bestseller-slider-{{ ai_gen_id }}>

<script>
  (function() {
    class BestsellerSlider{{ ai_gen_id }} extends HTMLElement {
      constructor() {
        super();
      }

      connectedCallback() {
        this.track = this.querySelector('[data-slider-track]');
        this.dots = this.querySelectorAll('[data-dot]');
        
        if (!this.track) return;

        this.setupSlider();
      }

      setupSlider() {
        let currentIndex = 0;

        this.track.addEventListener('scroll', () => {
          const scrollLeft = this.track.scrollLeft;
          const itemWidth = this.track.querySelector('.ai-bestseller-mobile-product-{{ ai_gen_id }}').offsetWidth;
          const gap = {{ block.settings.mobile_gap }};
          
          currentIndex = Math.round(scrollLeft / (itemWidth + gap));
          
          this.updateDots(currentIndex);
        });

        this.dots.forEach((dot, index) => {
          dot.addEventListener('click', () => {
            const itemWidth = this.track.querySelector('.ai-bestseller-mobile-product-{{ ai_gen_id }}').offsetWidth;
            const gap = {{ block.settings.mobile_gap }};
            
            this.track.scrollTo({
              left: index * (itemWidth + gap),
              behavior: 'smooth'
            });
          });
        });
      }

      updateDots(activeIndex) {
        this.dots.forEach((dot, index) => {
          if (index === activeIndex) {
            dot.classList.add('active');
          } else {
            dot.classList.remove('active');
          }
        });
      }
    }

    customElements.define('bestseller-slider-{{ ai_gen_id }}', BestsellerSlider{{ ai_gen_id }});
  })();
</script>

{% schema %}
{
  "name": "Bestseller slider",
  "tag": null,
  "settings": [
    {
      "type": "header",
      "content": "Products"
    },
    {
      "type": "product",
      "id": "product_1",
      "label": "Product 1"
    },
    {
      "type": "product",
      "id": "product_2",
      "label": "Product 2"
    },
    {
      "type": "product",
      "id": "product_3",
      "label": "Product 3"
    },
    {
      "type": "header",
      "content": "Badge"
    },
    {
      "type": "text",
      "id": "badge_text",
      "label": "Badge text",
      "default": "Bestseller"
    },
    {
      "type": "color",
      "id": "badge_background",
      "label": "Badge background",
      "default": "#0044cc"
    },
    {
      "type": "color",
      "id": "badge_text_color",
      "label": "Badge text color",
      "default": "#ffffff"
    },
    {
      "type": "header",
      "content": "Style"
    },
    {
      "type": "range",
      "id": "corner_radius",
      "min": 0,
      "max": 40,
      "step": 2,
      "unit": "px",
      "label": "Corner radius",
      "default": 12
    },
    {
      "type": "range",
      "id": "container_height",
      "min": 300,
      "max": 700,
      "step": 20,
      "unit": "px",
      "label": "Container height",
      "default": 500
    },
    {
      "type": "color",
      "id": "background_color",
      "label": "Background color",
      "default": "#fafaff"
    },
    {
      "type": "color",
      "id": "card_background",
      "label": "Card background",
      "default": "#ffffff"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text color",
      "default": "#090a0c"
    },
    {
      "type": "color",
      "id": "price_color",
      "label": "Price color",
      "default": "#0044cc"
    },
    {
      "type": "header",
      "content": "Desktop spacing"
    },
    {
      "type": "range",
      "id": "desktop_padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 40
    },
    {
      "type": "range",
      "id": "desktop_padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 40
    },
    {
      "type": "range",
      "id": "desktop_padding_sides",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "Left and right padding",
      "default": 40
    },
    {
      "type": "range",
      "id": "desktop_gap",
      "min": 8,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Gap between products",
      "default": 24
    },
    {
      "type": "header",
      "content": "Mobile spacing"
    },
    {
      "type": "range",
      "id": "mobile_padding_top",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Top padding",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_padding_bottom",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Bottom padding",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_padding_sides",
      "min": 0,
      "max": 60,
      "step": 4,
      "unit": "px",
      "label": "Left and right padding",
      "default": 20
    },
    {
      "type": "range",
      "id": "mobile_gap",
      "min": 8,
      "max": 40,
      "step": 4,
      "unit": "px",
      "label": "Gap between products",
      "default": 16
    },
    {
      "type": "color",
      "id": "dot_color",
      "label": "Slider dot color",
      "default": "#0044cc"
    }
  ],
  "presets": [
    {
      "name": "Bestseller slider"
    }
  ]
}
{% endschema %}
